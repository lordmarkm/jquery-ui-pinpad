/*! jquery.ui.pinpad | 1.0.0 | 2016-11-07 */
!function(a){"function"==typeof define&&define.amd?define(["jquery","jquery-ui"],a):a(jQuery)}(function(a){"use strict";return a.extend(a.ui.keyCode,{NUM_PAD_0:96,NUM_PAD_1:97,NUM_PAD_2:98,NUM_PAD_3:99,NUM_PAD_4:100,NUM_PAD_5:101,NUM_PAD_6:102,NUM_PAD_7:103,NUM_PAD_8:104,NUM_PAD_9:105,NUM_PAD_DECIMAL:110}),a.widget("ui.pinpad",{version:"1.0.0",defaultElement:"<input>",options:{autoComplete:!1,digitOnly:!1,clear:!1,minLength:0,maxLength:Number.MAX_VALUE,display:{decPoint:".",cancel:"Cancel",correct:"Correct",confirm:"Confirm"},keys:["1 2 3","4 5 6","7 8 9","{empty} 0 {dec}"],commands:[{position:0,name:"cancel",options:{icon:"ui-icon-close",iconPosition:"end"}},{position:1,name:"correct",options:{icon:"ui-icon-caret-1-w",iconPosition:"end"}},{position:2,name:"confirm",options:{icon:"ui-icon-radio-off",iconPosition:"end"}}],appendTo:null},_create:function(){var b=this,c=a(b.options.output),d=parseInt(b.element.attr("maxlength"),10),e=a();b.element.uniqueId(),0==c.length&&(c=b.element.clone().attr("id",b.element.attr("id")+"_output").removeAttr("maxlength"),c.insertAfter(b.element)),c.addClass("ui-pinpad-output").attr("role","pinpad-output"),a("label[for='"+b.element.attr("id")+"']").each(function(b,d){a(d).attr("for",c.attr("id"))}),b.outputElement=c,b.element.attr("role","pinpad-input"),b.element.val(b._getDefaultValue()),b._addClass("ui-pinpad-input","ui-helper-hidden"),!isNaN(d)&&d>0&&(b.options.maxLength=Math.max(b.options.minLength,d)),b.options.formatter||(b.options.formatter=a.ui.pinpad.defaultFormatter),b.options.appendTo&&(e=e.add(b.options.appendTo)),e.length?b.ppDiv=a("<div></div>").appendTo(e):b.ppDiv=a("<div></div>").insertAfter(c),b.ppDiv.addClass("ui-pinpad ui-widget ui-widget-content ui-helper-clearfix ui-corner-all").data("input",b.element),b._bindInputEvents(),b.refresh(),e.length||(delete b.options.appendTo,b.element.on("pinpadcancel",function(a,c){b.value(b.element.data("initialValue"))}),b.element.on("pinpadcancel pinpadconfirm",function(a,c){b.element.removeData("initialValue"),b._hide(b.ppDiv,b.options.hide)}),b.outputElement.on({focusin:function(a){b.ppDiv.is(":hidden")&&(b.element.data("initialValue",b.element.val()),b._show(b.ppDiv,b.options.show))},focusout:function(c){if(null!=c.relatedTarget){var d=a(c.relatedTarget).closest(".ui-pinpad").data("input");d&&d.attr("id")===b.element.attr("id")||b.cancel()}else b.cancel()}}),b.ppDiv.position({my:"left top",at:"left bottom",of:c}),b._addClass(b.ppDiv,null,"ui-front"),b._hide(b.ppDiv,!1))},_drawKeys:function(){var b,c,d,e,f=this,g=[],h=a("<div class='ui-pinpad-num-pad'></div>").appendTo(this.ppDiv),i=a("<table></table>").appendTo(h),j=a.ui.keyCode.NUM_PAD_0;for(a.each(this.options.keys,function(a,b){g.push(b.split(" "))}),d=0;d<g.length;d++)for(b=a("<tr></tr>").appendTo(i),e=0;e<g[d].length;e++){var k=g[d][e],l=parseInt(k,10);c=a("<td></td>").appendTo(b),isNaN(l)?/^\{\S+\}$/.test(k)&&(k=k.match(/^\{(\S+)\}$/)[1],"dec"===k?a("<button type='button' class='ui-pinpad-key ui-pinpad-key-num-pad-dec' data-key-code='"+a.ui.keyCode.NUM_PAD_DECIMAL+"' value='.'>"+this.options.display.decPoint+"</button>").appendTo(c).button({disabled:this.options.digitOnly}):"empty"===k&&a("<button type='button' class='ui-pinpad-key ui-pinpad-key-num-pad-empty' data-key-code='0'>&nbsp;</button>").appendTo(c).button()):a("<button type='button' class='ui-pinpad-key ui-pinpad-key-num-pad-"+l+"' data-key-code='"+(j+l)+"' value='"+l+"'>"+l+"</button>").appendTo(c).button()}this.ppDiv.find(".ui-pinpad-key").each(function(b,c){var d=a(c);f._bindKeyEvents(d)})},_drawCommands:function(){var b,c,d=this,e=d.options.commands,f=a("<div class='ui-pinpad-command-panel'></div>").appendTo(this.ppDiv),g=4,h=a("<table></table>").appendTo(f);for(c=0;c<g;c++){var i=a("<tr></tr>").appendTo(h),j=a("<td></td>").appendTo(i);b=a("<button class='ui-pinpad-command' type='button'>&nbsp;</button>").appendTo(j).button()}a.each(e,function(c,e){b=f.find("tr:eq("+e.position+") .ui-pinpad-command").addClass("ui-pinpad-command-"+e.name).attr("name",e.name).button("option",a.extend({},e.options,{label:d.options.display[e.name]})),d._bindCommandEvents(b)})},_updateCommands:function(b,c){var d=this.ppDiv.find(".ui-pinpad-command-panel");a.each(b,function(a,b){d.find(".ui-pinpad-command-"+b.name).button("option",{label:c[b.name]})})},_bindInputEvents:function(){var b=this;b._on({change:function(a){b._trigger("change",a);var c=b.element.val(),d=b.ppDiv.find(".ui-pinpad-command-confirm"),e=d.button("option","disabled"),f=c.length<b.options.minLength||b.options.autoComplete&&c.length<b.options.maxLength;f=f||b.element.is(".ui-pinpad-input-invalid"),b.outputElement.val(b.options.formatter.format(c,b.options)),f&&!e?d.button("disable"):!f&&e&&d.button("enable"),!f&&b.options.autoComplete&&c.length==b.options.maxLength&&b.confirm(),a.preventDefault()}}),b.outputElement.on({keydown:function(c){var d=c.keyCode;switch(d){case a.ui.keyCode.HOME:case a.ui.keyCode.END:case a.ui.keyCode.LEFT:case a.ui.keyCode.RIGHT:case a.ui.keyCode.UP:case a.ui.keyCode.DOWN:case a.ui.keyCode.TAB:return;case a.ui.keyCode.BACKSPACE:b.options.clear||b.ppDiv.find(".ui-pinpad-command-correct").click();break;case a.ui.keyCode.DELETE:b.options.clear&&b.ppDiv.find(".ui-pinpad-command-correct").click();break;case a.ui.keyCode.ENTER:b.ppDiv.find(".ui-pinpad-command-confirm").click();break;case a.ui.keyCode.ESCAPE:b.ppDiv.find(".ui-pinpad-command-cancel").click();break;case a.ui.keyCode.NUM_PAD_DECIMAL:b.ppDiv.find(".ui-pinpad-key-num-pad-dec").click();break;default:a.ui.pinpad.isDigit(d)&&b.ppDiv.find(".ui-pinpad-key-num-pad-"+(d-a.ui.keyCode.NUM_PAD_0)).click()}c.preventDefault()}})},_bindKeyEvents:function(b){this._on(b,{click:function(c){var d=b.data("keyCode"),e=this.element.val();this.outputElement.focus(),(a.ui.pinpad.isDigit(d)||a.ui.pinpad.isDecimalPoint(d)&&e.indexOf(".")==-1)&&e.length<this.options.maxLength&&this._trigger("keypress",c,d)&&this.value(e+b.val())}})},_bindCommandEvents:function(a){this._on(a,{click:function(b){a.is(".ui-pinpad-command-correct")?(this.outputElement.focus(),this.options.clear?this.clear():this.backspace()):this._trigger(a.attr("name"),b)}})},_isValid:function(b){var c=!1;return"string"==typeof b&&(c=0==b.length||a.ui.pinpad.isDecimalNumber(b)&&!(this.options.digitOnly&&b.indexOf(".")>-1)),c},_getCreateEventData:function(){return this.options},_getDefaultValue:function(){var a=this.element.val();return a&&this._isValid(a)?a:""},_getValue:function(){return this.element.val()},_setValue:function(a){this._isValid(a)&&(this.ppDiv.is(":hidden")&&(this.element.data("initialValue",this.element.val()),this._show(this.ppDiv,this.options.show)),this.element.val(a).change())},_setOption:function(a,b){var c=this;c._super(a,b),"display"===a?(this.ppDiv.find(".ui-pinpad-key-num-pad-dec").button("option","label",b.decPoint),this._updateCommands(this.options.commands,b)):"disabled"===a&&(b?(c.ppDiv.find(".ui-pinpad-key").button("disable"),c.ppDiv.find(".ui-pinpad-command-correct").button("disable"),c.ppDiv.find(".ui-pinpad-command-confirm").button("disable")):(c.ppDiv.find(".ui-pinpad-key").button("enable"),c.ppDiv.find(".ui-pinpad-key-num-pad-dec").button("option","disabled",c.options.digitOnly),c.ppDiv.find(".ui-pinpad-command-correct").button("enable"),c.element.change()))},_destroy:function(){this.ppDiv.remove(),this.element.next(),this.element.removeAttr("role").removeUniqueId(),this._off(this.element)},backspace:function(){var a=this.element.val(),b=a.length;b>0&&this.value(a.substring(0,b-1))},clear:function(){this.value("")},cancel:function(){this.ppDiv.find(".ui-pinpad-command-cancel").click()},confirm:function(){this.ppDiv.find(".ui-pinpad-command-confirm").click()},output:function(){return this.outputElement},refresh:function(){this.ppDiv.find("button").button("destroy"),this.ppDiv.empty(),this._drawKeys(),this._drawCommands(),this.ppDiv.find("button").button("refresh"),this.value(this.element.val())},value:function(a){if(void 0===a)return this._getValue();var b=a.toString();this._setValue(b.substring(0,Math.min(b.length,this.options.maxLength)))},widget:function(){return this.ppDiv}}),a.extend(a.ui.pinpad,{defaultFormatter:{format:function(a,b){return a.replace(".",b.display.decPoint)}},generateRandomKeys:function(){var a,b=[],c=[],d=[];for(a=0;a<10;a++)c.push(a);for(a=c.length;a>0;a--){var e=Math.floor(Math.random()*a),f=c[e];c.splice(e,1),d.push(f),d.length%3==0&&(b.push(d.join(" ")),d=[])}return b.push(d),b[b.length-1]="{empty} "+b[b.length-1]+" {empty}",b},isDigit:function(b){return b>=a.ui.keyCode.NUM_PAD_0&&b<=a.ui.keyCode.NUM_PAD_9},isDecimalPoint:function(b){return b==a.ui.keyCode.NUM_PAD_DECIMAL},isDecimalNumber:function(a){return/^\d+(\.\d*)?$/.test(a)}}),a.ui.pinpad});